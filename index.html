<!DOCTYPE html>
<html lang="ru">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>darginyegor | Лэндинги, интерфейсы, полиграфия - дизайн</title>
	<meta name="description" content="Дизайн посадочных страниц, интерфейсов, полиграфической продукции">
	<link rel="stylesheet" href="style.css">
</head>

<body class="ds-body ds-vue">
	<header class="ds-header ds-section">
		<div class="ds-header__content ds-section__content">
			<p class="ds-p">darginyegor</p>
			<div class="ds-header__links">
				<a href="" class="ds-header__link"></a>
				<a href="" class="ds-header__link"></a>
				<a href="" class="ds-header__link"></a>
			</div>
		</div>
	</header>
	<section class="ds-section">
		<div class="ds-section__content">
			<h1 class="ds-h1 ds-h1--main">
				Лэндинги&nbsp;<span class="--ds-colored-light">/</span><br>
				Интерфейсы&nbsp;<span class="--ds-colored-light">/</span><br>
				Полиграфия
			</h1>
			<a href="#form" class="ds-button ds-button--go">
				Нужен дизайн!
			</a>
		</div>
	</section>
	<div class="ds-separator">
		<a href="#portfolio" class="ds-h4 ds-separator__link --ds-anchor">
			Портфолио
		</a>
	</div>
	<section class="ds-section" id="portfolio">
		<div class="ds-section__content"></div>
	</section>
	<section class="ds-section ds-section--black" id="form">
		<div class="ds-section__content">
			<h1 class="ds-h1">Нужен дизайн?</h1>
			<div class="ds-wrapper">
				<form class="ds-form" name="request-form">
					<div class="ds-input">
						<label class="ds-input__label">Как к вам обращаться?</label>
						<input name="name" type="text" class="ds-input__input">
						<div class="ds-input__underline"></div>
					</div>
					<div class="ds-input ds-select">
						<label class="ds-input__label">Что будем разрабатывать?</label>
						<input type="text" name="product" class="ds-select__hidden-input" hidden>
						<div class="ds-input__input ds-select__input">&nbsp;</div>
						<div class="ds-select__dropdown">
							<div class="ds-select__dropdown-item">Посадочную страницу (лэндинг)</div>
							<div class="ds-select__dropdown-item">Интернет-магазин</div>
							<div class="ds-select__dropdown-item">Веб-приложение/систему</div>
							<div class="ds-select__dropdown-item">Полиграфическую продукцию</div>
							<div class="ds-select__dropdown-item">Что-то другое...</div>
						</div>
					</div>
					<div class="ds-input ds-input--last">
						<label class="ds-input__label">Оставите E-mail для связи?</label>
						<input name="email" type="email" class="ds-input__input">
						<div class="ds-input__underline"></div>
					</div>
					<button class="ds-button ds-button--go ds-button--submit">Отправить</button>
				</form>
				<div class="ds-form-result">
					<div class="ds-form-result__content">
						<div class="ds-form-result__icon"></div>
						<h4 class="ds-h4"></h4>
						<p class="ds-p"></p>
					</div>
				</div>
			</div>
		</div>
	</section>
	<footer class="ds-section ds-footer">
		<div class="ds-section__content ds-footer__content">
			<p class="ds-p ds-p--small">Example footer text</p>
		</div>
	</footer>
	<script>
		document.addEventListener('DOMContentLoaded', function () {
			const serverURL = 'http://localhost:3000';
			// Anchor smooth scroll handler
			document.querySelectorAll('[href*="#"]').forEach(function (each) {
				each.addEventListener('click', function (event) {
					event.preventDefault();
					const elementID = each.getAttribute("href").substr(1);
					document.getElementById(elementID).scrollIntoView({ behavior: 'smooth', block: 'start', inline: "nearest" });
				});
			});

			// Select opener
			document.querySelectorAll('.ds-select__input').forEach(function (each) {
				each.addEventListener('click', function (event) {
					const selectContainer = each.parentElement;
					selectContainer.querySelector('.ds-select__dropdown').classList.add('ds-select__dropdown--open');
					selectContainer.classList.remove('ds-input--complete');
				});
			});

			// Select closer
			document.querySelectorAll('.ds-select__dropdown-item').forEach(function (each) {
				each.addEventListener('click', function (event) {
					var dropdownElement = each.parentElement;
					var dropdownItems = dropdownElement.children;
					for (var item of dropdownItems) {
						item.classList.remove('ds-select__dropdown-item--selected');
					}
					each.classList.add('ds-select__dropdown-item--selected');
					dropdownElement.classList.remove('ds-select__dropdown--open');
					dropdownElement.parentElement.querySelector('.ds-select__input').innerText = each.innerText;
					dropdownElement.parentElement.querySelector('input').value = each.innerText;
					dropdownElement.parentElement.classList.remove('ds-input--invalid');
				});
			});

			// Input errors remover
			document.querySelectorAll('input').forEach(function (each) {
				each.addEventListener('focus', function(event) {
					const controlContainer = event.target.closest('.ds-input');
					controlContainer.classList.remove('ds-input--complete');
				})
			})

			// Form submitter
			document.querySelector('.ds-button--submit').addEventListener('click', function (event) {
				event.preventDefault();
				const form = document.forms['request-form'];
				const formControls = form.elements;
				var formValid = true;
				var requestBody = {};
				for (var control of formControls) {
					if (!control.name) continue;
					var controlContainer = control.closest('.ds-input');
					controlContainer.classList.remove('ds-input--invalid');
					if (control.value) {
						requestBody[control.name] = control.value;
						controlContainer.classList.add('ds-input--complete');
					} else {
						controlContainer.classList.add('ds-input--invalid');
						formValid = false;
					}
				}
				if (!formValid) return;
				form.classList.add('ds-form--disabled');
				var xhr = new XMLHttpRequest();
				xhr.open('POST', serverURL + '/request');
				xhr.send(JSON.stringify(requestBody));
				xhr.addEventListener('readystatechange', function(event) {
					if (this.readyState == 4) {
						const error = (this.status != 200);
						const formResult = document.querySelector('.ds-form-result');
						const iconClassModifier = error ? 'error' : 'success';
						formResult.querySelector('.ds-form-result__icon').classList.add('ds-form-result__icon--' + iconClassModifier);
						formResult.querySelector('.ds-h4').innerText = error ? 'Что-то не так...' : 'Готово';
						formResult.querySelector('.ds-p').innerText = error ? 'Не удалось отправить данные!' : 'Ваша заявка отправлена.';
						formResult.classList.add('ds-form-result--visible');
					}
				})
			})
		});
	</script>
</body>
</html>